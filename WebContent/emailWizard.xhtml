<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:gc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:pe="http://primefaces.org/ui/extensions" >
	<h:head></h:head>
	<h:body>
		<!-- Center content update area -->
		<div class="blog-post shadow">
			<!--  
			<p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />

			<p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
			    <p:graphicImage name="img/emailSending.gif" />
			</p:dialog>
			-->
			
			<h:form id="weeklyEmailForm" enctype="multipart/form-data">
				<h3>Submit Weekly Summary Email:</h3>
				<hr/>
				<p:wizard flowListener="#{emailWizardBean.onFlowProcess}">
					<!-- Recipient Details Tab -->
					<p:tab id="recipients" title="Recipients" >
						<p:panel header="Recipient Selection" >
							<p:messages />
							<h:panelGrid columns="2" columnClasses="label, value" >
								<h:outputText value="Send to All NEC: " styleClass="widget-text" />
								<p:selectBooleanCheckbox value="#{emailWizardBean.sendToAll}" >
									<p:ajax update="selection" />
								</p:selectBooleanCheckbox>
								
								<h:outputText value="Send to Selected:" styleClass="widget-text" />
								<p:selectManyCheckbox id="selection" disabled="#{emailWizardBean.sendToAll}" value="#{emailWizardBean.selectedRecipients}" layout="grid" columns="2" >
									<f:selectItems value="#{emailWizardBean.recipients}" />
								</p:selectManyCheckbox>
							</h:panelGrid>
						</p:panel>
					</p:tab>
					<!-- Message Details Tab -->
					<p:tab id="details" title="Details" >
						<p:panel header="Email Send Details" >
							<p:messages />
							<h:panelGrid columns="2" columnClasses="label, value" >
								<h:outputText value="Subject: *" styleClass="widget-text" />
								<p:inputText value="#{emailWizardBean.subject}" required="true" label="Subject" />
								
								<h:outputText value="Message Title: *" styleClass="widget-text" />
								<p:inputText value="#{emailWizardBean.title}" required="true" label="Title" />
								
								<h:outputText value="Message Subtitle: " styleClass="widget-text" />
								<p:inputText value="#{emailWizardBean.subtitle}" label="Subtitle" />
								
								<h:outputText value="Message Headline: *" styleClass="widget-text" />
								<p:inputText value="#{emailWizardBean.headline}" label="Headline" />
							</h:panelGrid>
						</p:panel>
					</p:tab>
					<!-- Image Details Tab -->
					<p:tab id="image" title="Image">
						<p:panel header="Email Image Details" >
							<p:messages />
							<h:panelGrid columns="2" columnClasses="label, value" >
								<h:outputText value="Use Default Image: " styleClass="widget-text" />
								<p:selectBooleanCheckbox value="#{emailWizardBean.useDefaultImage}" >
									<p:ajax update="imageUpload" />
								</p:selectBooleanCheckbox>
								
								<h:outputText value="Upload Content Image: " styleClass="widget-text" />
								<p:fileUpload id="imageUpload" 
											  mode="advanced" 
									  		  skinSimple="true" update="growl" 
									  		  disabled="#{emailWizardBean.useDefaultImage}"
									  		  fileUploadListener="#{emailWizardBean.upload}" />
									  
								<h:outputText value="Image Caption: " styleClass="widget-text" />
								<p:inputText value="#{emailWizardBean.imgCaption}" label="Caption" />
								
								<h:outputText value="Link Destination: " styleClass="widget-text" />
						        <p:selectOneMenu value="#{emailWizardBean.captionDestination}">
						            <f:selectItem itemLabel="Select One" itemValue="" />
						            <f:selectItems value="#{emailWizardBean.pageDestinations}" />
						        </p:selectOneMenu>
							</h:panelGrid>
						</p:panel>
					</p:tab>
					<!-- Message Text Tab -->
					<p:tab id="messageText" title="Message" >
						<h3 style="margin-top:0">Edit Message Text:</h3>
						<p:messages />
						<pe:ckEditor id="editor" value="#{emailWizardBean.emailContent}" style="width:100%">  
   							<p:ajax event="blur" listener="#{emailWizardBean.saveListener}" update="growl emailSubmit"/>  
						</pe:ckEditor>
						<!-- <p:textEditor widgetVar="editor1" value="#{emailWizardBean.messageText}" height="300" style="margin-bottom:10px"/>  -->
						<h:panelGrid columns="2" columnClasses="label, value" >
							<h:outputText value="Submit: "  styleClass="widget-text"/>
							<p:commandButton id="emailSubmit" value="Submit" disabled="#{emailWizardBean.sendDisabled}" actionListener="#{emailWizardBean.send}" update="growl" process="@this"/>
						</h:panelGrid>
					</p:tab>
				</p:wizard>
			</h:form>
		</div>
	</h:body>
</html>
